<div class="pdx-field-container pdx-rating-container" [class]="cssClasses() + ' ' + fieldCssClasses()">

  <label class="pdx-field-label" [class.required]="metadata()?.required" [for]="componentId() + '-rating'">
    {{ metadata()?.label }}
    <span *ngIf="metadata()?.required" class="pdx-required-marker" aria-hidden="true">*</span>
  </label>

  <div class="pdx-field-control">
    <div class="pdx-rating-stars"
         [id]="componentId() + '-rating'"
         [class.readonly]="isReadonly()"
         [class.disabled]="effectiveDisabled()"
         role="radiogroup"
         [attr.aria-label]="'Rating from 0 to ' + (metadata()?.max || 5)"
         [attr.aria-describedby]="getAriaDescribedBy()">

      <button *ngFor="let star of getStars(); trackBy: trackByIndex"
              type="button"
              class="pdx-rating-star"
              [class.filled]="star.filled"
              [class.half]="star.half"
              [class.empty]="star.empty"
              [class.hover]="star.hover"
              [disabled]="effectiveDisabled() || isReadonly()"
              [attr.aria-label]="getStarAriaLabel(star.index)"
              [attr.aria-checked]="star.filled"
              role="radio"
              (click)="selectRating(star.value)"
              (mouseenter)="onStarHover(star.index)"
              (mouseleave)="onStarLeave()"
              (keydown)="onStarKeyDown($event, star.index)">

        <mat-icon *ngIf="star.filled" [color]="materialColor()">
          {{ metadata()?.icon || 'star' }}
        </mat-icon>

        <mat-icon *ngIf="star.half" [color]="materialColor()" class="pdx-half-star">
          {{ metadata()?.icon || 'star' }}
        </mat-icon>

        <mat-icon *ngIf="star.empty" class="pdx-empty-star">
          {{ metadata()?.emptyIcon || 'star_border' }}
        </mat-icon>
      </button>
    </div>

    <div *ngIf="showValueDisplay()" class="pdx-rating-value">
      {{ formatRatingValue(fieldValue()) }} / {{ metadata()?.max || 5 }}
    </div>
  </div>

  <div class="pdx-field-hints">
    <div *ngIf="metadata()?.hint && !hasValidationError()" class="pdx-field-hint" [id]="componentId() + '-hint'">
      {{ metadata()?.hint }}
    </div>

    <div *ngIf="hasValidationError()" class="pdx-field-error" [id]="componentId() + '-error'" role="alert">
      {{ primaryErrorMessage() }}
    </div>
  </div>
</div>
